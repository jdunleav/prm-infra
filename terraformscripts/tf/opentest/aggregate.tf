module "opentest" {
  source = "../modules/opentest/"

  aws_region = "${var.aws_region}"

  environment = "${var.environment}"
  ssh_public  = "${var.ssh_public}"
  vpc_id      = "${var.vpc_id}"
  vpc_cidr    = "${var.vpc_cidr}"

  vpc_subnet_private_ids = "${var.vpc_subnet_private_ids}"
  opentest-assets-bucket = "${var.opentest-assets-bucket}"

  route_cidr_blocks = "${var.route_cidr_blocks}"
}

resource "aws_route53_zone" "opentest" {
  name = "opentest.hscic.gov.uk"

  vpc {
    vpc_id = "${var.vpc_id}"
  }
}

resource "aws_route53_record" "opentest_msg" {
  zone_id = "${aws_route53_zone.opentest.zone_id}"
  name    = "msg.${aws_route53_zone.opentest.name}"
  type    = "A"
  ttl     = "300"
  records = ["192.168.128.11"]
}
